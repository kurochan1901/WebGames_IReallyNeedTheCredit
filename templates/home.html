{% extends "base.html" %}

{% block content %}

<div class="layout-container">

  <!-- 左側欄：排行榜（暫填資料） -->
  <aside class="side-panel left-panel">
    <h2>
      <a href="{{ url_for('leaderboard') }}" style="text-decoration: none; color:inherit;">
        排行榜
      </a>
    </h2>
    
    <!-- 改用 /api/leaderboard -->
    <ul>
      {% for r in recent_records %}
      <li>
        {{loop.index}}.
        {{r["username"]}} 
        - {{"勝利" if r["winner"] == "player" else "失敗"}}
        - {{r["rounds"]}} 回合
        <small>({{r["played_at"]}})</small>
      </li>
      {% else %}
      <li>目前還沒有任何遊玩紀錄</li>
      {% endfor %}
    </ul>

    <a class="btn" href="{{ url_for('leaderboard') }}">查看完整排行榜</a>
  </aside>

  <!-- 中央主視覺＋按鈕 -->
  <main class="main-panel">

    <!-- 主視覺圖預留 -->
    <div class="hero">
      <div class="hero-image-placeholder">
        主視覺圖片<br>
        （未來放遊戲 Banner）
      </div>
    </div>

    <div class="home-buttons">

      {% if not session.get('player_id') %}
        <!-- 未登入時 -->
        <div class="button-row">
          <a class="btn btn-primary" href="{{ url_for('login_form') }}">登入</a>
          <a class="btn btn-secondary" href="{{ url_for('register_form') }}">註冊</a>
        </div>
        <button class="btn btn-disabled" disabled title="請先登入">開始遊戲</button>

      {% else %}
        <!-- 已登入時 -->
        <p class="welcome">歡迎回來，{{ session.get('username') }}！</p>

        <a class="btn btn-primary" href="{{ url_for('main_game') }}">開始遊戲</a>

        <form method="post" action="{{ url_for('logout') }}" style="margin-top: 12px;">
          <button class="btn btn-secondary" type="submit">登出</button>
        </form>

      {% endif %}

    </div>
  </main>

  <!-- 右側欄：廣告區 -->
  <aside class="side-panel right-panel">
    <h2>布告欄</h2>
    <div class="ad-box">
      冒險者，你們在尋找什麼？
    </div>
  </aside>

</div>

{% endblock %}
