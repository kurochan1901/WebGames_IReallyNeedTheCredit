{% extends "base.html" %}

{% block content %}

<div class="layout-container">

  <!-- å·¦å´æ¬„ï¼šæ’è¡Œæ¦œï¼ˆæš«å¡«è³‡æ–™ï¼‰ -->
  <aside class="side-panel left-panel">
    <h2>
      <a href="{{ url_for('leaderboard') }}" style="text-decoration: none; color:inherit;">
        æ’è¡Œæ¦œ
      </a>
    </h2>
    
    <!-- æ”¹ç”¨ /api/leaderboard -->
    <ul>
      {% for r in recent_records %}
      <li>
        {{loop.index}}.
        {{r["username"]}} 
        - {{"å‹åˆ©" if r["winner"] == "player" else "å¤±æ•—"}}
        - {{r["rounds"]}} å›åˆ
        <small>({{r["played_at"]}})</small>
      </li>
      {% else %}
      <li>ç›®å‰é‚„æ²’æœ‰ä»»ä½•éŠç©ç´€éŒ„</li>
      {% endfor %}
    </ul>

    <a class="btn" href="{{ url_for('leaderboard') }}">æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œ</a>
  </aside>

  <!-- ä¸­å¤®ä¸»è¦–è¦ºï¼‹æŒ‰éˆ• -->
  <main class="main-panel">

    <!-- ä¸»è¦–è¦ºåœ–é ç•™ -->
    <div class="hero">
      <div class="hero-image-placeholder">
        <img src="{{ url_for('static', filename='img/background.png') }}">
      </div>
    </div>

    <div class="home-buttons">

      {% if not session.get('player_id') %}
        <!-- æœªç™»å…¥æ™‚ -->
        <div class="button-row">
          <a class="btn btn-primary" href="{{ url_for('login_form') }}">ç™»å…¥</a>
          <a class="btn btn-secondary" href="{{ url_for('register_form') }}">è¨»å†Š</a>
        </div>
        <button class="btn btn-disabled" disabled title="è«‹å…ˆç™»å…¥">é–‹å§‹éŠæˆ²</button>

      {% else %}
        <!-- å·²ç™»å…¥æ™‚ -->
        <p class="welcome">æ­¡è¿å›ä¾†ï¼Œ{{ session.get('username') }}ï¼</p>

        <a class="btn btn-primary" href="{{ url_for('main_game') }}">é–‹å§‹éŠæˆ²</a>

        <form method="post" action="{{ url_for('logout') }}" style="margin-top: 12px;">
          <button class="btn btn-secondary" type="submit">ç™»å‡º</button>
        </form>

      {% endif %}

    </div>
  </main>

  <!-- å³å´æ¬„ï¼šå»£å‘Šå€ -->
  <aside class="side-panel right-panel">
    <h2>å¸ƒå‘Šæ¬„</h2>
    <div class="ad-box">
      å†’éšªè€…ï¼Œä½ å€‘åœ¨å°‹æ‰¾ä»€éº¼ï¼Ÿ
    </div>

    <a class="btn" href="/minigame/rush">ğŸ® Rush å°éŠæˆ²</a>

  </aside>

</div>

{% endblock %}
